## 쿠키, 세션, 웹스토리지

HTTP는 요청과 응답을 주고 받아 한 사이클이 종료되면 연결이 끊어지는 **무상태성**을 가지고 있다.

그래서 클라이언트 상태를 보존하지않는다.

클라이언트의 상태를 **클라이언트에 저장해두고** 필요시마다 데이터를 꺼내서 사용하는 방식으로 HTTP의 단점을 보완하고자 **쿠키와 웹 스토리지를 사용**한다.

세션은 클라이언트가 아닌 **서버에 저장하고 관리한다.**

<br />

### 쿠키

- 쿠키 : 사용자가 특정한 웹 사이트에 방문할 때, **사용자 컴퓨터에 저장**하는 기록 파일이다.

  - **서버의 자원을 전혀 사용하지않는다.**

  - 사용 예시 : 아이디와 비밀번호를 저장하시겠습니까?

- 쿠키의 동작 방식

  - 클라이언트가 페이지 요청

  - **서버가 HTTP 응답 시 set-cookie를 통해 쿠키 생성하여 전달** => 브라우저에 저장

  - 클라이언트는 이제부터 매 HTTP Request시 HTTP Header에 쿠키를 담아서 전송

### 세션

- 세션 : 한명의 사용자(브라우저)의 상태를 유지하는 기술이다.

  - 서버가 DB에 세션을 생성하고 클라이언트에게 고유한 Session ID를 부여하면, 클라이언트는 접속할 때마다 Session ID를 함께 요청한다.

  - 사용 예시 : 웹 사이트에 한번 로그인하면, 다른 페이지로 이동해도 **계속 접속 상태가 유지**된다.

  - 만약 이 Session ID를 다른 클라이언트에게 탈취당하면, 다른 사람이 자신의 행세를 할 수 있다.

- 세션 인증 방식 예시

    <img width="850" alt="스크린샷 2024-03-01 150814" src="https://github.com/yookeunbyul/cs-study/assets/91243651/8a4f86f5-bd97-4d39-a7ee-9f8d8a8cb79c">

  1.클라이언트가 로그인 페이지(화면)를 요청

  2.서버는 요청을 받아 로그인 페이지를 응답. 브라우저가 화면에 표현

  3.아이디와 패스워드를 파라미터로 함께 보내서 로그인 요청을하면 서버가 데이터베이스를 검증한다. 회원정보가 일치할시 세션을 생성하거나 기존에 있는 세션을 유지 후 클라이언트에 세션 ID를 보내준다.

  4.그럼 클라이언트는 **브라우저에 세션 정보를 저장한다.**

  5.클라이언트는 가지고 있는 세션 아이디와 함께 요청(글쓰기 혹은 메일함 확인하기) 수행

  6.서버는 세션 ID를 가지고 회원 ID를 접근해 클라이언트가 원하는 작업을 할 수 있도록 해준다.

<br />

### 쿠키와 세션

```
둘다 HTTP의 무상태성을 보완하기위해 사용하는데 쿠키는 클라이언트(브라우저)에 저장하고 세션은 서버에 저장하고 관리한다.

쿠키는 저장위치 때문에 스니핑 당할 우려가 있지만, 세션은 쿠키를 이용해 세션 아이디만 브라우저에 저장하고 서버에서 처리하기 때문에 보안성은 쿠키보다 세션이 더 좋다.

쿠키는 브라우저를 종료해도 만료기간이 남아있으면 남아있지만, 세션은 브라우저 종료 시 만료기간에 상관없이 종료된다.
```

<br />

### 웹 스토리지

클라이언트에 데이터를 저장할 수 있도록 HTML5부터 나온 새로운 방식의 데이터 저장소.

종류는 로컬 스토리지와 세션 스토리지가 있다.

Key, value 쌍의 형태로 데이터 저장

#### 로컬 스토리지와 세션 스토리지

- 로컬 스토리지는 **데이터 영구 저장**이 가능, 세션스토리지는 **브라우저 탭/윈도우가 닫히면 스토리지가 초기화**

- 브라우저에서 같은 웹사이트를 여러번 탭이나 창에 띄우면, 여러개의 세션 스토리지에 데이터가 서로 격리 되어 저장되고, 각 탭 혹은 창이 닫힐때 저장해 둔 데이터도 함께 소멸

- 로컬스토리지의 경우 여러 탭이나 창 간에 데이터가 서로 공유되며 (같은 도메인일 경우), 탭이나 창을 닫아도 데이터는 브라우저에 그대로 남아 있습니다. (동일 컴퓨터 + 동일 브라우저 종류(크롬, 사파리, 오페라 등등) 환경인 가정 하에)

<br />

### 참고

https://joyhong-91.tistory.com/51
